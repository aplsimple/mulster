<!DOCTYPE html><html><head><meta charset="utf-8"/>
<link rel="stylesheet" href="../../../zoo/sh/styles/aplsimple.css">
<title>::transpops reference</title>
<style>
/*
Copyright (c) 2009, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.net/yui/license.txt
version: 2.7.0
*/
html{color:#000;background:#FFF;}body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,button,textarea,p,blockquote,th,td{margin:0;padding:0;}table{border-collapse:collapse;border-spacing:0;}fieldset,img{border:0;}address,caption,cite,code,dfn,em,strong,th,var,optgroup{font-style:inherit;font-weight:inherit;}del,ins{text-decoration:none;}li{list-style:none;}caption,th{text-align:left;}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal;}q:before,q:after{content:'';}abbr,acronym{border:0;font-variant:normal;}sup{vertical-align:baseline;}sub{vertical-align:baseline;}legend{color:#000;}input,button,textarea,select,optgroup,option{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;}input,button,textarea,select{*font-size:100%;}body{font:13px/1.231 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small;}select,input,button,textarea,button{font:99% arial,helvetica,clean,sans-serif;}table{font-size:inherit;font:100%;}pre,code,kbd,samp,tt{font-family:Consolas,"Courier New",monospace;font-size:100%;line-height:100%;}body{text-align:center;}#doc,#doc2,#doc3,#doc4,.yui-t1,.yui-t2,.yui-t3,.yui-t4,.yui-t5,.yui-t6,.yui-t7{margin:auto;text-align:left;width:57.69em;*width:56.25em;}#doc2{width:73.076em;*width:71.25em;}#doc3{margin:auto;width:auto;}#doc4{width:74.923em;*width:73.05em;}.yui-b{position:relative;}.yui-b{_position:static;}#yui-main .yui-b{position:static;}#yui-main,.yui-g .yui-u .yui-g{width:100%;}.yui-t1 #yui-main,.yui-t2 #yui-main,.yui-t3 #yui-main{float:right;margin-left:-25em;}.yui-t4 #yui-main,.yui-t5 #yui-main,.yui-t6 #yui-main{float:left;margin-right:-25em;}.yui-t1 .yui-b{float:left;width:12.30769em;*width:12.00em;}.yui-t1 #yui-main .yui-b{margin-left:13.30769em;*margin-left:13.05em;}.yui-t2 .yui-b{float:left;width:9.8461em;*width:13.50em;}.yui-t2 #yui-main .yui-b{margin-left:10.8461em;*margin-left:14.55em;}.yui-t3 .yui-b{float:left;width:23.0769em;*width:22.50em;}.yui-t3 #yui-main .yui-b{margin-left:24.0769em;*margin-left:23.62em;}.yui-t4 .yui-b{float:right;width:13.8456em;*width:13.50em;}.yui-t4 #yui-main .yui-b{margin-right:14.8456em;*margin-right:14.55em;}.yui-t5 .yui-b{float:right;width:18.4615em;*width:18.00em;}.yui-t5 #yui-main .yui-b{margin-right:19.4615em;*margin-right:19.125em;}.yui-t6 .yui-b{float:right;width:23.0769em;*width:22.50em;}.yui-t6 #yui-main .yui-b{margin-right:24.0769em;*margin-right:23.62em;}.yui-t7 #yui-main .yui-b{display:block;margin:0 0 1em 0;}#yui-main .yui-b{float:none;width:auto;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf,.yui-gc .yui-u,.yui-gd .yui-g,.yui-g .yui-gc .yui-u,.yui-ge .yui-u,.yui-ge .yui-g,.yui-gf .yui-g,.yui-gf .yui-u{float:right;}.yui-g div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first,.yui-ge div.first,.yui-gf div.first,.yui-g .yui-gc div.first,.yui-g .yui-ge div.first,.yui-gc div.first div.first{float:left;}.yui-g .yui-u,.yui-g .yui-g,.yui-g .yui-gb,.yui-g .yui-gc,.yui-g .yui-gd,.yui-g .yui-ge,.yui-g .yui-gf{width:49.1%;}.yui-gb .yui-u,.yui-g .yui-gb .yui-u,.yui-gb .yui-g,.yui-gb .yui-gb,.yui-gb .yui-gc,.yui-gb .yui-gd,.yui-gb .yui-ge,.yui-gb .yui-gf,.yui-gc .yui-u,.yui-gc .yui-g,.yui-gd .yui-u{width:32%;margin-left:1.99%;}.yui-gb .yui-u{*margin-left:1.9%;*width:31.9%;}.yui-gc div.first,.yui-gd .yui-u{width:66%;}.yui-gd div.first{width:32%;}.yui-ge div.first,.yui-gf .yui-u{width:74.2%;}.yui-ge .yui-u,.yui-gf div.first{width:24%;}.yui-g .yui-gb div.first,.yui-gb div.first,.yui-gc div.first,.yui-gd div.first{margin-left:0;}.yui-g .yui-g .yui-u,.yui-gb .yui-g .yui-u,.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u,.yui-ge .yui-g .yui-u,.yui-gf .yui-g .yui-u{width:49%;*width:48.1%;*margin-left:0;}.yui-g .yui-g .yui-u{width:48.1%;}.yui-g .yui-gb div.first,.yui-gb .yui-gb div.first{*margin-right:0;*width:32%;_width:31.7%;}.yui-g .yui-gc div.first,.yui-gd .yui-g{width:66%;}.yui-gb .yui-g div.first{*margin-right:4%;_margin-right:1.3%;}.yui-gb .yui-gc div.first,.yui-gb .yui-gd div.first{*margin-right:0;}.yui-gb .yui-gb .yui-u,.yui-gb .yui-gc .yui-u{*margin-left:1.8%;_margin-left:4%;}.yui-g .yui-gb .yui-u{_margin-left:1.0%;}.yui-gb .yui-gd .yui-u{*width:66%;_width:61.2%;}.yui-gb .yui-gd div.first{*width:31%;_width:29.5%;}.yui-g .yui-gc .yui-u,.yui-gb .yui-gc .yui-u{width:32%;_float:right;margin-right:0;_margin-left:0;}.yui-gb .yui-gc div.first{width:66%;*float:left;*margin-left:0;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf .yui-u{margin:0;}.yui-gb .yui-gb .yui-u{_margin-left:.7%;}.yui-gb .yui-g div.first,.yui-gb .yui-gb div.first{*margin-left:0;}.yui-gc .yui-g .yui-u,.yui-gd .yui-g .yui-u{*width:48.1%;*margin-left:0;}.yui-gb .yui-gd div.first{width:32%;}.yui-g .yui-gd div.first{_width:29.9%;}.yui-ge .yui-g{width:24%;}.yui-gf .yui-g{width:74.2%;}.yui-gb .yui-ge div.yui-u,.yui-gb .yui-gf div.yui-u{float:right;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf div.first{float:left;}.yui-gb .yui-ge .yui-u,.yui-gb .yui-gf div.first{*width:24%;_width:20%;}.yui-gb .yui-ge div.first,.yui-gb .yui-gf .yui-u{*width:73.5%;_width:65.5%;}.yui-ge div.first .yui-gd .yui-u{width:65%;}.yui-ge div.first .yui-gd div.first{width:32%;}#hd:after,#bd:after,#ft:after,.yui-g:after,.yui-gb:after,.yui-gc:after,.yui-gd:after,.yui-ge:after,.yui-gf:after{content:".";display:block;height:0;clear:both;visibility:hidden;}#hd,#bd,#ft,.yui-g,.yui-gb,.yui-gc,.yui-gd,.yui-ge,.yui-gf{zoom:0;}

body{margin:10px;}h1{font-size:138.5%;}h2{font-size:123.1%;}h3{font-size:108%;}h1,h2,h3{margin:1em 0;}h1,h2,h3,h4,h5,h6,strong,dt{font-weight:bold;}optgroup{font-weight:normal;}abbr,acronym{border-bottom:1px dotted #000;cursor:help;}em{font-style:italic;}del{text-decoration:line-through;}blockquote,ul,ol,dl{margin:1em;}ol,ul,dl{margin-left:2em;}ol li{list-style:decimal outside;}ul li{list-style:disc outside;}dl dd{margin-left:1em;}th,td{border:1px solid #000;padding:.5em;}th{font-weight:bold;text-align:center;}caption{margin-bottom:.5em;text-align:center;}sup{vertical-align:super;}sub{vertical-align:sub;}p,fieldset,table,pre{margin-bottom:1em;}button,input[type="checkbox"],input[type="radio"],input[type="reset"],input[type="submit"]{padding:1px;}

/* Ruff default CSS */

body {
  /*max-width: 70em;*/
  margin: 0;
}

h1,h2 {
  color: #888888;
  margin-bottom: 0.5em;
  margin-top: 0em;
}

#ft { font-size: x-small; font-family: Arial, sans-serif;
  text-align: left;
  border-top: 1px solid #0B3467;
  color: #888888;
  margin-top: 10px;
}

.banner h2 {
  color: #0B3467;
}

#hd.banner {
 font-family: "Times New Roman", serif;
 font-size: 200%;
 line-height: 64px;
 border-bottom: thin solid #0B3467;
 color: #0B3467;
}

p.linkline {
  text-align: right;
  font-size: smaller;
  /*    margin-top: -1em; */
  margin-bottom: 0;
}

.tinylink {
  font-size: x-small;
  font-variant: normal;
  font-family: Arial, sans-serif;
  float: right;
  padding:2px;
}

h1 .tinylink a {
  color: white;
}

#bd {
font-family: Arial, sans-serif;
/*font-size: 108%;*/
}

div.navbox {
  /* margin-top: 1em; */
  background-color: #0B3467;
  color: white;
  padding: 3px 4px 2px 4px;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

div.navbox:hover {
  overflow: visible;
}

/* Note .navbox header css should be based on $header_levels */
.navbox h1, .navbox h2, .navbox h3, .navbox h4, .navbox h5 {
  font-size: 85%;
  margin: 0px;
  font-weight: normal;
}
.navbox h1 {
  font-weight: bold; /* Override */
}
.navbox h2 {
  padding-left: 1em;
}
.navbox h3 {
  padding-left: 2em;
}
.navbox h4 {
  padding-left: 2.5em;
  font-weight: normal;
}
.navbox h5 {
  padding-left: 3em;
  font-weight: normal;
}
.navbox hr {
  color: white;
  margin-top:0.1em;
  margin-bottom:0.1em;
}

.navbox a:link, .navbox a:visited, .navbox a:hover {
  text-decoration: none;
  color: white;
  background-color: #0B3467;
}

.navbox a:hover {
   font-weight: bold;
}

/* Tooltip text - see https://www.w3schools.com/css/css_tooltip.asp */
.tooltip {
  position: relative;
  /* display: inline-block; */
}

.tooltip .tooltiptext {
  width: 100%;
  font-weight: bold;
  background-color: white;
  color: #0B3467;
  text-align: left;
  border: 1px solid #0B3467;
  /* border-radius: 4px; */
  position: absolute;
  z-index: 1;
  margin-left: 4px;
  padding: 2px 3px;
  visibility: hidden;
}

/* Show the tooltip text when you mouse over the tooltip container */
.tooltip:hover .tooltiptext {
  visibility: visible;
}

span.ns_scope {
  color: #aaaaaa;
}

span.ns_scope a:link, span.ns_scope a:visited {
  text-decoration: none;
  color: #aaaaaa;

}

li {
  margin-top: 0.5em;
}

span.ns_scope a:hover {
  text-decoration: none;
  color: #666666;
}

table {
  margin: 1em;
  margin-top: 0.5em;
  border: thin solid;
  border-collapse: collapse;
  border-color: #808080;
  padding: 4px;
}

td {
  border: thin solid;
  border-color: #808080;
  vertical-align: top;
  font-size: 93%;
  padding: 0.3em;
  padding-top: 0.1em;
}
th {
  border: thin solid;
  border-color: #808080;
  padding: 0.3em;
  padding-top: 0.1em;
  background-color: #CCCCCC;
}

dt, dd {
   font-size: 93%;
}

h1.ruff {
  background-color: #0B3467;
  color: #ffffff;
  padding-left: 0.2em;
  font-family: "Times New Roman", serif;
}
h2.ruff {
  font-variant: small-caps;
  color: #0B3467;
  font-weight: bold;
  font-family: "Times New Roman", serif;
}

h3.ruff, h4.ruff, h5.ruff, h6.ruff {
  color: #0B3467;
}
h5.ruff {
  font-style: italic;
  font-weight: normal;
}
h6.ruff {
  font-weight: normal;
}
h3.ruffclass, h3.ruffproc, h3.ruffmethod,
h4.ruffclass, h4.ruffproc, h4.ruffmethod,
h5.ruffclass, h5.ruffproc, h5.ruffmethod {
  border-bottom: thin solid #0B3467;
  color: #0B3467;
  margin-bottom: 0.2em;
}

pre {
  background-color: #f9f9f9;
  margin-top: 1em;
  margin-left: 1em;
  padding: 5px;
  font-family: Consolas, "Courier New", monospace;
  /* width: max-content; --- to leave footsteps */ overflow: auto;
  line-height: 1.2em;
}

.ruff_dyn_src {
  display: none; /* Displayed via JS */
}

.ruff_synopsis {
  border: thin solid #cccccc;
  background: #f9f9f9;
  font-family: Consolas, "Courier New", monospace;
  padding: 5px;
  margin: 0em 2em 1em;
}
.ruff_const, .ruff_cmd, ruff_defitem {
  font-weight: bold;
  font-family: Consolas, "Courier New", monospace;
}
.ruff_arg {
  font-style: italic;
  font-family: Consolas, "Courier New", monospace;
}

.ruff_source_link {
  font-size: smaller;
}

.ruff_index {
  font-size: small;
  color: grey;
  line-height: 1;
}

.ruff_index ul li {
  list-style-type: none;
}

.ruff_index ul li a {
  text-decoration: none;
}
</style>
<script>function toggleSource( id )
{
  /* Copied from Rails */
  var elem
  var link

  if( document.getElementById )
  {
      elem = document.getElementById( id )
      link = document.getElementById( "l_" + id )
  }
  else if ( document.all )
  {
      elem = eval( "document.all." + id )
      link = eval( "document.all.l_" + id )
  }
  else
      return false;

  if( elem.style.display == "block" )
  {
      elem.style.display = "none"
      link.innerHTML = "Show source"
  }
  else
  {
      elem.style.display = "block"
      link.innerHTML = "Hide source"
  }
}
</script></head>
<meta name="author" content="aplsimple">
<meta name="description" content="aplsimple's home page">
<meta name="keywords" content="aplsimple,home">
<link rel="stylesheet" href="../../../en/zoo/style.css">
<style>
table{
background-color: #f9f9f9;
margin: 0%;
margin-bottom: 2%;
padding: 0%;
box-shadow: none;
filter: none;
}
pre{
margin: 0%;
margin-bottom: 2%;
padding: 0%;
}
</style>
<link rel="icon" type="image/jpg" href="../../../zoo/favicon.jpg">
<body>
<div id="wrapper">
<div name="divd1" ALIGN="CENTER"> <FONT SIZE=5em color=#b01c20><B>
<noscript>THIS PAGE IS NOT WORKING WITHOUT JAVASCRIPT!
<BR>
<BR>PLEASE, SWITCH ON JAVASCRIPT IN SETTINGS OF YOUR BROWSER AND RELOAD THE PAGE.
</noscript>
</B></FONT></div>
<div id='doc3' class='yui-t2'>
<script src="../../../zoo/funcs.js"></script>
<script src="../../../en/zoo/this.js"></script>
<section id=sec2>
<div id='hd' class='banner'>
<a name='transpops.html'>::transpops reference</a>
</div>
<div id='bd'><div id='yui-main'><div class='yui-b'><h1 class='ruff'><a name='::transpops'></a>::transpops<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>The Tcl/Tk <em>transpops</em> package displays popup messages. Fit for demos, though may be used otherwise.</p>
<p class='ruff'>The messages are read from a <em>text file</em> and after pressing a <em>hotkey</em> are shown one by one, in transparent mode. The most representative examples of the <em>text files</em> are in demos/alited/ subdirectories which result in <a href="https://github.com/aplsimple/alited/releases/download/Demos_of_alited-1.3.5/2.Units_alited-1.3.5.mp4" >alited's units demo</a>, for example.</p>
<p class='ruff'>First called, the popup message is displayed under the mouse pointer. The following messages will be displayed at the same screen coordinates if not reset with an <em>alternative hotkey</em>.</p>
<p class='ruff'>The popup messages will be hidden at clicking them.</p>
<p class='ruff'>Also, you can draw on the screen, by means of <a href="https://chiselapp.com/user/aplsimple/repository/drawscreen" >drawscreen</a>.</p>
<p class='ruff'><em>Note for apave package</em>. The apave's showModal method includes a specific bind of Ctrl-Alt-0 keys to hide the transpops messages with these keys (because a modal window captures any clicks).</p>
<p class='ruff'><hr></p>
<p class='ruff'>Runs this way:</p>
<pre class='ruff'><br><code class="tcl">
package require transpops
::transpops::run transpops.txt wins ?events? ?fg? ?bg? ?events2? ?options?
<br></code></pre>
<p class='ruff'>where:</p>
<ul class='ruff'>
<li><em>transpops.txt</em> - name of <em>text file</em> containing messages</li>
<li><em>wins</em> - list of toplevel windows the events are bound to</li>
<li><em>events</em> - events to show messages at mouse pointer as last and forced, default &quot;Alt-t Alt-y&quot;</li>
<li><em>fg, bg</em> - foreground and background colors</li>
<li><em>events2</em> - list of events to start drawing on the screen, default &quot;Control-x Control-X&quot;</li>
<li><em>options</em> - options of <a href="https://chiselapp.com/user/aplsimple/repository/drawscreen" >drawscreen</a></li>
</ul>
<p class='ruff'><hr></p>
<p class='ruff'>License: MIT.</p>
<br><h2 class='ruff'><a name='::transpops-Commands'></a>Commands<span class='tinylink'><a href='transpops.html#::transpops'>transpops</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::transpops::run'>run</a><span class='ns_scope'> [<a href="transpops.html#::transpops" title="::transpops" class='ruff_cmd'>::transpops</a>]</span><span class='tinylink'><a href='transpops.html#::transpops'>transpops</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Runs my::Run and catches errors. Logs errors to a log file.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>run</span> <span class='ruff_arg'>?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>arguments of my::Run.</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_transpops_run' href="javascript:toggleSource('transpops_run')">Show source</a></p>
<div id='transpops_run' class='ruff_dyn_src'><pre><br><code class="tcl">proc ::transpops::run {args} {
  # Runs my::Run and catches errors. Logs errors to a log file.
  #   args - arguments of my::Run.

  if {[catch {my::Run {*}$args} err]} {
    catch {
      set ch [open ~/TMP/transpops.log a]
      puts $ch $err
      close $ch
    }
  }
}<br><br></code></pre></div>
</div><br><br><h1 class='ruff'><a name='::transpops::my'></a>::transpops::my<span class='tinylink'><a href='#top'>Top</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>The <em>::transpops::my</em> namespace contains procedures for internal usage by <em>transpops</em> package.</p>
<br><h2 class='ruff'><a name='::transpops::my-Commands'></a>Commands<span class='tinylink'><a href='transpops.html#::transpops::my'>my</a>, <a href='#top'>Top</a></span></h2>
<div style='clear:both;'></div>
<br><br><br><h4 class='ruffproc'><a name='::transpops::my::OptionVar'>OptionVar</a><span class='ns_scope'> [<a href="transpops.html#::transpops::my" title="::transpops::my" class='ruff_cmd'>::transpops::my</a>]</span><span class='tinylink'><a href='transpops.html#::transpops::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Name of variable for transpops options.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>OptionVar</span> <span class='ruff_arg'>tag</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>tag</code></code></td><td class='ruff_defitem'>options' tag (common name or message's index)</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_transpops_my_OptionVar' href="javascript:toggleSource('transpops_my_OptionVar')">Show source</a></p>
<div id='transpops_my_OptionVar' class='ruff_dyn_src'><pre><br><code class="tcl">proc ::transpops::my::OptionVar {tag} {
  # Name of variable for transpops options.
  #   tag - options' tag (common name or message's index)

  return &quot;::transpops::my::_TP_OPTIONS_$tag&quot;
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::transpops::my::Popup'>Popup</a><span class='ns_scope'> [<a href="transpops.html#::transpops::my" title="::transpops::my" class='ruff_cmd'>::transpops::my</a>]</span><span class='tinylink'><a href='transpops.html#::transpops::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Popups a message in the popup window.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Popup</span> <span class='ruff_arg'>msg</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>msg</code></code></td><td class='ruff_defitem'>the message</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_transpops_my_Popup' href="javascript:toggleSource('transpops_my_Popup')">Show source</a></p>
<div id='transpops_my_Popup' class='ruff_dyn_src'><pre><br><code class="tcl">proc ::transpops::my::Popup {msg} {
  # Popups a message in the popup window.
  #   msg - the message

  variable wmsgs
  variable alpha
  variable alphaincr
  variable cntwait
  variable waitfactor
  if {![winfo exists $wmsgs]} return
  if {$cntwait&gt;0} {
    incr cntwait -1
  } else {
    set alpha [expr {$alpha+$alphaincr}]
    if {$alpha&gt;1.0} {
      set cntwait [expr {int(max(2,[string length $msg]/$waitfactor)/$alphaincr)}]
      set alphaincr [expr {-$alphaincr}]
      set alpha 1.0
    } elseif {$alpha&lt;0.0} {
      catch {destroy $wmsgs}
      return
    }
    catch {wm attributes $wmsgs -alpha $alpha}
  }
  after 10 &quot;::transpops::my::Popup {$msg}&quot;
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::transpops::my::Run'>Run</a><span class='ns_scope'> [<a href="transpops.html#::transpops::my" title="::transpops::my" class='ruff_cmd'>::transpops::my</a>]</span><span class='tinylink'><a href='transpops.html#::transpops::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Initializes and runs the popup messages.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Run</span> <span class='ruff_arg'>fname wins ?events? ?fg1? ?bg1? ?events2? ?args?</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>fname</code></code></td><td class='ruff_defitem'>name of file containing the messages</td></tr>
<tr><td class='ruff_defitem'><code><code>wins</code></code></td><td class='ruff_defitem'>the list of parent window pathes</td></tr>
<tr><td class='ruff_defitem'><code><code>events</code></code></td><td class='ruff_defitem'>events on the window to run bound popups; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
<tr><td class='ruff_defitem'><code><code>fg1</code></code></td><td class='ruff_defitem'>foreground of popups; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
<tr><td class='ruff_defitem'><code><code>bg1</code></code></td><td class='ruff_defitem'>background of popups; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
<tr><td class='ruff_defitem'><code><code>events2</code></code></td><td class='ruff_defitem'>events to start drawing; <i>optional, default</i> <code>&quot;&quot;</code></td></tr>
<tr><td class='ruff_defitem'><code><code>args</code></code></td><td class='ruff_defitem'>options of <em>drawscreen</em></td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_transpops_my_Run' href="javascript:toggleSource('transpops_my_Run')">Show source</a></p>
<div id='transpops_my_Run' class='ruff_dyn_src'><pre><br><code class="tcl">proc ::transpops::my::Run {fname wins {events {}} {fg1 {}} {bg1 {}} {events2 {}} args} {
  # Initializes and runs the popup messages.
  #   fname - name of file containing the messages
  #   events - events on the window to run bound popups
  #   wins - the list of parent window pathes
  #   fg1 - foreground of popups
  #   bg1 - background of popups
  #   events2 - events to start drawing
  #   args -  options of *drawscreen*

  variable draw
  variable msgs
  variable imsgs
  variable fg
  variable bg
  variable textTags
  if {$events eq {}} {set events {Alt-t Alt-y}}
  if {$fg1 eq {}} {set fg1 #000000}
  if {$bg1 eq {}} {set bg1 #FBFB95}
  set fg $fg1
  set bg $bg1
  set chan [open $fname]
  chan configure $chan -encoding utf-8
  set msgs [list]
  set merge no
  foreach line [split [read $chan] \n] {
    # skip comments
    if {[string index $line 0] eq {#}} {
      # comments may be valuable
      set line [string trim [string range $line 1 end]]
      set ov [split $line]
      lassign $ov o v
      if {[string match TRANSPOP* $o]} {
        # set/use options of transpops
        # e.g.
        #   # TRANSPOPred -foreground #000 -background red
        #   # TRANSPOP2   -foreground #fff -background black
        # then using them:
        #   # TRANSPOP2
        #   # TRANSPOPred
        # also to set tags r, b, g:
        #   TRANSPOP TAG b -font {-weight bold -size 20 -family Mono} -foreground red
        # and using:
        #   this is &lt;b&gt;bolded text&lt;/b&gt;
        if {[string match {TRANSPOP TAG *} $line]} {
          set nam [lindex $line 2]
          set tag [list $nam [lrange $line 3 end]]
          if {[set i [lsearch -exact -index 0 $textTags $nam]]&gt;-1} {
            set textTags [lreplace $textTags $i $i $tag]
          } else {
            lappend textTags $tag
          }
          continue
        }
        set varOPTS [OptionVar $o]
        if {$v ne {}} {
          # setting options
          set $varOPTS [lrange $ov 1 end]
        } elseif {[info exists $varOPTS]} {
          # using options
          set llen [llength $msgs]
          if {!$merge} {incr llen}
          set [OptionVar $llen] [set $varOPTS]
        }
      }
      continue
    }
    # if it's a list of items, mark them accordingly
    if {[regexp {^\s*[*]\s+} $line]} {
      set i [string first * $line]
      set line [string range $line 0 $i-1]\u2022[string range $line $i+1 end]
    }
    # if line has &quot;\\&quot; at its end, it continues a message
    set line2 [string map {{ } {} - {} + {} / {} \\ {} * {} = {}} $line]
    set continued [expr {$line2 ne {} || $line eq {}}]
    if {$continued} {
      if {$merge} {
        set last [lindex $msgs end]
        append last \n $line
        set msgs [lreplace $msgs end end $last]
      } else {
        lappend msgs $line
      }
    }
    set merge $continued
  }
  close $chan
  set imsgs 0
  set timo 300
  set draw(events) $events2
  set draw(opts) $args
  foreach w $wins {
    set ei 0
    foreach ev $events {
      after $timo [list ::transpops::my::RunMe $w $ev [list ::transpops::my::Show $w [incr ei]]]
    }
    if {$draw(app)} {bind $w &lt;Escape&gt; exit}
  }
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::transpops::my::RunMe'>RunMe</a><span class='ns_scope'> [<a href="transpops.html#::transpops::my" title="::transpops::my" class='ruff_cmd'>::transpops::my</a>]</span><span class='tinylink'><a href='transpops.html#::transpops::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Binds an event on a window to a script.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>RunMe</span> <span class='ruff_arg'>w ev scrp</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>w</code></code></td><td class='ruff_defitem'>the window's path</td></tr>
<tr><td class='ruff_defitem'><code><code>ev</code></code></td><td class='ruff_defitem'>event on the window</td></tr>
<tr><td class='ruff_defitem'><code><code>scrp</code></code></td><td class='ruff_defitem'>the bound script</td></tr>
</table>
<h5 class='ruff'>Description</h5><p class='ruff'>The binding is made only on an existing window. The windows may be created and destroyed, so Run watches if they are available.</p>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_transpops_my_RunMe' href="javascript:toggleSource('transpops_my_RunMe')">Show source</a></p>
<div id='transpops_my_RunMe' class='ruff_dyn_src'><pre><br><code class="tcl">proc ::transpops::my::RunMe {w ev scrp} {
  # Binds an event on a window to a script.
  #   w - the window's path
  #   ev - event on the window
  #   scrp - the bound script
  # The binding is made only on an existing window.
  # The windows may be created and destroyed, so Run watches if they are available.

  variable draw
  if {[winfo exists $w]} {
    if {[string first $scrp [bind $w $ev]]==-1} {
      if {![string match &lt;*&gt; $ev]} {set ev &lt;$ev&gt;}
      bind $w $ev &quot;$scrp ; break&quot;
    }
#    ::drawscreen run $w $draw(events) {*}$draw(opts)
  }
  after 200 [list ::transpops::my::RunMe $w $ev $scrp]
}<br><br></code></pre></div>
</div><br><br><br><h4 class='ruffproc'><a name='::transpops::my::Show'>Show</a><span class='ns_scope'> [<a href="transpops.html#::transpops::my" title="::transpops::my" class='ruff_cmd'>::transpops::my</a>]</span><span class='tinylink'><a href='transpops.html#::transpops::my'>my</a>, <a href='#top'>Top</a></span></h4>
<div style='clear:both;'></div>
<p class='ruff'>Makes the popup toplevel window and starts popups.</p>
<div class='ruff_synopsis'><span class='ruff_cmd'>Show</span> <span class='ruff_arg'>win evn</span></div>
<h5 class='ruff'>Parameters</h5><table class='ruff_deflist'>
<tr><td class='ruff_defitem'><code><code>win</code></code></td><td class='ruff_defitem'>parent window's path</td></tr>
<tr><td class='ruff_defitem'><code><code>evn</code></code></td><td class='ruff_defitem'>index of event (2nd sets the geometry)</td></tr>
</table>
<div class='ruff_source'><p class='ruff_source_link'><a id='l_transpops_my_Show' href="javascript:toggleSource('transpops_my_Show')">Show source</a></p>
<div id='transpops_my_Show' class='ruff_dyn_src'><pre><br><code class="tcl">proc ::transpops::my::Show {win evn} {
  # Makes the popup toplevel window and starts popups.
  #   win - parent window's path
  #   evn - index of event (2nd sets the geometry)

  variable geom
  variable text
  variable textTags
  variable msgs
  variable imsgs
  variable wmsgs
  variable alpha
  variable alphaincr
  variable cntwait
  variable fg
  variable bg
  set fS red
  set wmsgs [string trimright $win .].transpops
  catch {destroy $wmsgs}
  while {1} {
    if {[incr imsgs]&gt;[llength $msgs]} return
    set msg [string trim [lindex $msgs $imsgs-1]]
    if {$msg ne {}} break
  }
  set rows 0
  set cols 10
  set text {}
  foreach row [split $msg \n] {
    set row [string trim $row]
    append text $row \n
    set row [string map [list &lt;r&gt; {} &lt;/r&gt; {} &lt;b&gt; {} &lt;/b&gt; {} &lt;g&gt; {} &lt;/g&gt; {} &lt;link&gt; {} &lt;/link&gt; {}] $row]
    if {[set c [string length $row]]&gt;$cols} {set cols $c}
    incr rows
  }
  catch {
    # when used within apave theme, disable theming transpops
    ::apave::obj untouchWidgets *.transpops*
  }
  toplevel $wmsgs
  wm withdraw $wmsgs
  wm overrideredirect $wmsgs 1
  wm attributes $wmsgs -topmost yes
  set varOPTS [OptionVar $imsgs]
  if {[info exists $varOPTS]} {
    set opts [set $varOPTS]
  } else {
    set opts {}
  }
  set wtxt $wmsgs.labtrans
  set font {-weight bold -size 16 -family Mono}
  if {[catch {
    set text [string trim $text]
    text $wtxt -padx 30 -pady 30 -foreground $fg -background $bg  -font $font  -relief solid {*}$opts -width $cols -height $rows -state disabled
    pack $wtxt
    ::apave::obj initLinkFont -underline 1 {*}$font -foreground $fg -background $bg
    ::apave::obj displayTaggedText $wtxt ::transpops::my::text $textTags
  } e]} then {
    catch {destroy $wtxt}
    label $wtxt -padx 30 -pady 30 -foreground $fg -background $bg  -font $font  -relief solid -text $msg -justify left {*}$opts
    pack $wtxt -fill both -expand true
  }
  set alpha 0.0
  set alphaincr [expr {abs($alphaincr)}]
  set alpha 0.0
  set alphaincr 0.007
  set cntwait 0
  bind $wmsgs &lt;ButtonPress&gt; {set ::transpops::my::cntwait 0}
  if {[regexp {^http[s]?://\S+$} $msg]} {
    catch {
      ::apave::obj makeLabelLinked $wtxt  &quot;::apave::openDoc $msg@@$msg@@&quot; $fg $bg $fg yellow
    }
  }
  set x [expr {[winfo pointerx $win]+10}]
  set y [expr {[winfo pointery $win]+10}]
  if {$geom eq {} || $evn==2} {set geom +$x+$y}
  wm geometry $wmsgs $geom
  after 10 &quot;wm deiconify $wmsgs; wm attributes $wmsgs -alpha 0.0 -topmost 1&quot;
  after 15 &quot;::transpops::my::Popup {$msg}&quot;
}<br><br></code></pre></div>
</div></div></div><div class='yui-b navbox' ><h1><a href='#::transpops'>transpops</a></h1><h2><a href='#::transpops-Commands'>Commands</a></h2><h4 class='tooltip'><a href='transpops.html#::transpops::run'>run</a><span class='tooltiptext'>Runs my::Run and catches errors. Logs errors to a log file.
</span></h4><h1><a href='#::transpops::my'>transpops::my</a></h1><h2><a href='#::transpops::my-Commands'>Commands</a></h2><h4 class='tooltip'><a href='transpops.html#::transpops::my::OptionVar'>OptionVar</a><span class='tooltiptext'>Name of variable for transpops options.
</span></h4><h4 class='tooltip'><a href='transpops.html#::transpops::my::Popup'>Popup</a><span class='tooltiptext'>Popups a message in the popup window.
</span></h4><h4 class='tooltip'><a href='transpops.html#::transpops::my::Run'>Run</a><span class='tooltiptext'>Initializes and runs the popup messages.
</span></h4><h4 class='tooltip'><a href='transpops.html#::transpops::my::RunMe'>RunMe</a><span class='tooltiptext'>Binds an event on a window to a script.
</span></h4><h4 class='tooltip'><a href='transpops.html#::transpops::my::Show'>Show</a><span class='tooltiptext'>Makes the popup toplevel window and starts popups.
</span></h4></div></div><div id='ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div></div>
</div></body></html>
